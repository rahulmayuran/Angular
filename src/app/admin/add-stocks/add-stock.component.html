<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Company</title>

</head>

<body>
    <button class="btn btn-danger" (click)="back()"> Back</button>

    <!-- company form -->
    <form [formGroup]=companyForm>

        <div class="container-fluid">

            <h4 class="navbar bg-warning clearfix fontChange">COMPANY</h4>

            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Company Name</th>
                        <th>CEO</th>
                        <th>Official Website</th>
                        <th>Annual Turnover</th>
                        <th>Stock Exchange</th>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngFor="let a of company">

                        <td> <input type="text" [(ngModel)]="a.companyName" formControlName="companyName"></td>
                        <td> <input type="text" [(ngModel)]="a.companyCEO" formControlName="companyCEO"></td>
                        <td> <input type="text" style="width: 400px;" [(ngModel)]="a.companyWebsite"
                                placeholder="https://" formControlName="companyWebsite"></td>
                        <td> <input type="number" [(ngModel)]="a.companyTurnover" formControlName="companyTurnover"
                                placeholder="In lakhs"></td>
                        <td>
                            <select [(ngModel)]="a.exchangeType" formControlName="exchangeType">
                                <option>NSE</option>
                                <option>BSE</option>
                            </select>
                        </td>
                        <td>
                            <button class="btn btn-outline-success" (click)="Persistcompany(a)"
                                [disabled]="checkcompany()"
                                [ngStyle]="checkcompany() ? {'color' : 'gray'} : {'color' : 'green'}" type="submit">
                                <i class="fa fa-floppy-o"> Save</i></button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <button class="btn btn-outline-primary" (click)="addcompany()" type="submit"><i class="fa fa-plus-circle">
                    Company</i></button>
            <button class="btn btn-outline-danger" (click)="popcompany()" type="submit"><i class="fa fa-minus-circle">
                    Company</i></button>
            <button class="btn btn-outline-danger" type="reset" value="reset"><i class="fa fa-eraser">
                    Reset</i></button>

        </div>

        <br />

        <button class="btn btn-outline-primary btn-block" (click)="fetchcompanies()" type="submit"> <i
                class="fa fa-usd"> Fetch Companies</i> </button>

        <div class="row justify-content-center row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 ">
            <div *ngFor="let company of resultcompany" class="card cardStructure">
                <div class="card-body cardContents">
                    <h4 class="card-title fontChange">{{company.companyName}}</h4>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">Annual Turnover - {{company.companyTurnover}} Lakhs</li>
                    <li class="list-group-item">CEO - {{company.companyCEO}}</li>
                    <li class="list-group-item">Website - <a href="{{company.companyWebsite}}"
                            target="_blank">{{company.companyWebsite}}</a></li>
                    <li class="list-group-item"> Exchange -
                        <span class="badge badge-success">
                            <div *ngIf=company.isNSE>NSE</div>
                            <div *ngIf=company.isBSE>BSE</div>
                        </span>
                    </li>
                </ul>
                <div class="card-body  bg-dark">
                    <button class="btn btn-success btn-sm" (click)="addstock(company)" type="submit"><i
                            class="fa fa-plus-circle"> stock</i></button>
                    <button class="btn btn-danger btn-sm" (click)="deletecompany(company.companyId)" type="submit"><i
                            class="fa fa-trash"> company</i></button>
                </div>
            </div>
        </div>

    </form>
    <!-- stock Form -->
    <form [formGroup]=stockForm>

        <div class="container-fluid" *ngIf="stock.length!=0">
            <h4 class="navbar bg-warning clearfix fontChange">STOCK</h4>
            <div class="container-fluid">

                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>company Name</th>
                            <th>Stock price</th>
                        </tr>
                    </thead>

                    <tbody *ngFor="let resultStock of stock">
                        <tr>
                            <td> {{resultStock.company?.companyName}}</td>
                            <td> <input type="number" [(ngModel)]="resultStock.stockPrice" name=stockPrice
                                    formControlName="stockPrice"></td>
                        </tr>
                        <div class="btn-group btn-block">
                            <button class="btn btn-outline-success" (click)="Persiststock(resultStock)" type="submit"
                                [disabled]="checkstock()"
                                [ngStyle]="checkstock() ? {'color' : 'gray'} : {'color' : 'green'}"><i
                                    class="fa fa-floppy-o"> Save Stock </i></button>
                        </div>
                    </tbody>
                </table>
                <br />
                <button class="btn btn-outline-primary btn-block" (click)="fetchstocks()" type="submit">
                    <i class="fa fa-line-chart"> Fetch Stocks </i>
                    <span class="badge badge-dark"> {{resultstock.length}} </span>
                </button>

                <!-- Fetch stock Details -->
                <div class="scrollbar">
                    <!-- [ngStyle]="{height: resultstock.length > 4 ? '13em' : '13em'}"> -->
                    <table *ngIf="stock.length!=0" class="table table-striped table-hover">
                        <thead class="bg-dark text-light fontChange">
                            <tr>
                                <th>Company</th>
                                <th>Stock Id</th>
                                <th>Stock Price</th>
                                <th>Stock Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody *ngFor="let displayStock of resultstock">
                            <tr>
                                <td class="bg-secondary text-light">{{displayStock?.companyName}}</td>
                                <td>{{displayStock.stockId}}</td>
                                <td>{{displayStock.stockPrice}}</td>
                                <td>{{displayStock.stockDate | date : 'dd/MM/yy h:mm:ss a'}}</td>
                                <button class="btn btn-danger btn-sm" (click)="deletestock(displayStock.stockId)"
                                    type="submit"> <i class="fa fa-trash"> Delete</i> </button>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </form>

    <app-confirmation *ngIf="confirmationPopup" [yesText]="yesText" [noText]="noText" [popupTitle]="popupTitle"
        [popupQuestion]="popupQuestion" (action)="actionConfirmed($event)" class="popup">
    </app-confirmation>
</body>

</html>